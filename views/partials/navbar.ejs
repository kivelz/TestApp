<div class="preloader"></div>

<nav class="navbar navbar-expand-lg sticky-top navbar-dark bg-dark">
  <a class="navbar-brand" href="/"><i class="fas fa-paw mr-2"></i>SPS</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
    aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item active">
        <% if(!currentUser) { %>
        <a class="nav-link" href="/users/login">Login</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/users/register">Sign up</a>
      </li>
      <% } if(currentUser && currentUser.isAdmin) { %>

     <li class="nav-item dropdown">
                          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Notifications <span class="badge badge-secondary"><%= notifications.length %></span></a>
                          <ul class="dropdown-menu">
                            <li>
                                <a class="dropdown-item" href="/notifications">View past notifications</a>
                            </li>
                            <% notifications.forEach(function(notification) { %>                          
                                <li>
                                    <a class="dropdown-item" href="/users/notifications/<%= notification.id %>">
                                        <%= notification.username %> created a new Listing
                                    </a>
                                </li>
                            <% }); %>
                          </ul>
                        </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true"
          aria-expanded="false">
          <img id="userProfileImg" src="<%=currentUser.local.images.url%>" alt="<%=currentUser.local.firstName%>" style="height: 25px; width: 25px; border-radius: 100%"> <span><%=currentUser.local.firstName%></span> 
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
          <a class="dropdown-item" href="/users/profiler/<%= currentUser.id %>">Account</a>
          <a class="dropdown-item" href="admin">Admin Menu</a>
          <a class="dropdown-item" href="users/logout">Log out</a>
        </div>
      </li>
      <li class="nav-item">
        <a href="/services" class="nav-link">Home</a>
      </li>
      <li class="nav-item">
        <a href="/services/new" class="nav-link">Create</a>
      </li>
      
      <% } if(currentUser && !currentUser.isAdmin) { %>
      < <li class="nav-item dropdown">
                          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Notifications <span class="badge badge-secondary"><%= notifications.length %></span></a>
                          <ul class="dropdown-menu">
                            <li>
                                <a class="dropdown-item" href="/notifications">View past notifications</a>
                            </li>
                            <% notifications.forEach(function(notification) { %>                          
                                <li>
                                    <a class="dropdown-item" href="/users/notifications/<%= notification.id %>">
                                        <%= notification.username %> created a new Listing
                                    </a>
                                </li>
                            <% }); %>
                          </ul>
                        </li>
                        
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuNormal" data-toggle="dropdown" aria-haspopup="true"
          aria-expanded="false">
        <img id="userProfileImg" src="<%=currentUser.local.images.url%>" alt="<%=currentUser.local.firstName%>" style="height: 25px; width: 25px; border-radius: 100%"> <span><%=currentUser.local.firstName%></span> 
        <img id="userProfileImg" src="<%=currentUser.facebook.avatar%>" alt="<%=currentUser.facebook.name%>" style="height: 30px; width: 30px; border-radius: 100%"> <span><%=currentUser.facebook.name%></span> 
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuNormal">
          <a class="dropdown-item" href="/users/profiler/<%= currentUser.id %>">Account</a>
          <a class="dropdown-item" href="/users/logout">Log out</a>
        </div>
      </li>
      <li class="nav-item">
        <a href="/services" class="nav-link">Home</a>
      </li>
      <li class="nav-item">
        <a href="/services/new" class="nav-link">Create</a>
      </li>
      <% } %>
    </ul>
   
  </div>
</nav>


<div class=" justify-content-center">
  <% if(success && success.length > 0 ) { %>
  <div class="alert alert-success" style="margin: 0 auto;">
    <%= success %>
  </div>
  <% } %>

  <% if(error && error.length > 0 ) { %>
  <div class="alert alert-danger" style="margin: 0 auto;">
    <%= error %>
  </div>
  <% } %>
</div>